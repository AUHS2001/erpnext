<style>
.print-format th,
.print-format td {
	padding-top: 1px !important;
	padding-bottom: 1px !important;
}
</style>

{% var attendance_color_map = {
	'Present': 'green',
	'Holiday': 'color: black; font-weight: bold;',
	'Half Day': 'orange',
	'On Leave': 'blue',
	'Absent': 'red'
} %}

<h2 class="text-center">
	{%= __("Cumulative Time Sheet") %}
</h2>

<h4 class="text-center">
	{% if (filters.from_date == filters.to_date) { %}
    	{%= moment(filters.from_date).format('MMMM YYYY') %}
	{% } else { %}
   		{%= moment(filters.from_date).format('MMMM YYYY') %}
		{% if (moment(filters.from_date).format('MMMM') != moment(filters.to_date).format('MMMM')) { %}
			{%= __(" - ") %}
			{%= moment(filters.to_date).format('MMMM YYYY') %}
		{% } else { %}
			{%= __(" ") %}
		{% } %}
	{% } %}
</h4>

<div class="clearfix">
	<div class="pull-left" style="width: 50%;">
		<div><b>Employee Name:</b> {%= filters.employee_name %} </div>
		<div><b>Designation:</b> {%= filters.designation %} </div>
		<div><b>Department:</b> {%= filters.department %} </div>
	</div>
	<div class="pull-right text-right" style="width: 50%;">
		<div><b>From Date:</b> {%= moment(filters.from_date).format('Do MMM, YYYY') %} </div>
		<div><b>To Date:</b> {%= moment(filters.to_date).format('Do MMM, YYYY') %} </div>
	</div>
</div>
<table class="table table-bordered">
	<thead>
		<tr>
			<th class="text-left" width="12%" rowspan="2">{%= __("Date") %}</th>
			<th class="text-left" width="11%" rowspan="2">{%= __("Day") %}</th>
			<th class="text-left" colspan="2">{%= __("Shift") %}</th>
			<th class="text-left" colspan="2">{%= __("Employee Checkin") %}</th>
			<th class="text-right" width="7%" rowspan="2">{%= __("Hours") %}</th>
			<th class="text-left" width="10%" rowspan="2">{%= __("Status") %}</th>
			<th class="text-left" width="9%" rowspan="2">{%= __("Late Hours") %}</th>
			<th class="text-left" width="8%" rowspan="2">{%= __("Early Hours") %}</th>
		</tr>
		<tr>
			<th class="text-left" width="9%">{%= __("Start") %}</th>
			<th class="text-left" width="9%">{%= __("End") %}</th>
			<th class="text-left" width="12%">{%= __("Time In") %}</th>
			<th class="text-left" width="13%">{%= __("Time Out") %}</th>
		</tr>
	</thead>
	<tbody>
		{% for(var i=0, l=data.length; i<l; i++) { %}
			<tr>
				<td class="text-left">{%= frappe.datetime.str_to_user(data[i].date) %}</td>
				<td class="text-left">{%= data[i].day %}</td>
				<td class="text-left">{%= data[i].shift_start ? moment(data[i].shift_start, 'HH:mm:ss').format('h:mm A') : "" %}</td>
				<td class="text-left">{%= data[i].shift_end ? moment(data[i].shift_end, 'HH:mm:ss').format('h:mm A') : "" %}</td>
				<td class="text-left">{%= data[i].checkin_time_1 %}</td>
				<td class="text-left">{%= data[i].checkin_time_2%}</td>
				<td class="text-right">{%= data[i].working_hours %}</td>
				<td class="text-left" style="color: {%= attendance_color_map[data[i].attendance_status] + ' !important' %};">
					{%= data[i].attendance_status ? data[i].attendance_status : '' %}
				</td>
				<td class="text-left">{%= data[i].late_entry %}</td>
				<td class="text-left">{%= data[i].early_exit %}</td>
			</tr>
		{% } %}
	</tbody>
</table>
<div>
	<h2 class="text-center">{%= __("Attendance Summary") %}</h2>
	<div>
		<span><b>Total Working Hours:</b> {%= filters.employee_name %} </span>
		<span><b>Total Present:</b> {%= filters.employee_name %} </span>
	</div>
	<div>
		<span><b>Total Late Hours:</b> {%= filters.employee_name %} </span>
		<span><b>Total Absent:</b> {%= filters.employee_name %} </span>
	</div>
	<div>
		<span><b>Total Early Hours:</b> {%= filters.employee_name %} </span>
		<span><b>Total Late Holidays:</b> {%= filters.employee_name %} </span>
	</div>
	<div>
		<span><b>&nbsp;</b>&nbsp;</span>
		<span><b>Net Present Day + Holidays:</b> {%= filters.employee_name %} </span>
	</div>
</div>